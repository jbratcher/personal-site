{
  "date": "2020-04-22T16:43:31.392Z",
  "body": "\nYou should get a perfect score from a Google Lighthouse audit with a base install of a Nuxt Application after building and running in production mode. In the test for this post, I got a 97 in performance with all 100s in the rest of the categories and passing PWA tests.\r\n\r\nIf you use the generate command to render everything as static, the performance score hits 100.\r\n\r\nThis pre-configured base is a big selling point for Nuxt which abstracts away the most common configurations and best practices for Vue apps.\r\n\r\n## Performance Takes A Big Hit As Dependencies and Assets Grow\r\n\r\nThe kicker is that when you start to add third-party libraries, fonts, icons, and heavy assets like images the performance score can take a nosedive.\r\n\r\nI noticed this when building out web apps. Performance scores would often drop significantly depending on the package size of the library or due to un-optimized images.\r\n\r\nThis isn't a fault of Nuxt however as there are several community modules that allow you to optimize for performance.\r\n\r\nThus began my journey of optimizing the Nuxt configuration for performance.\r\n\r\n## Performance\r\n\r\n### Render Blocking Resources\r\n\r\nLighthouse performance audit may detect render blocking resources which are resources that increase the time it takes to render the page. The size of these resources directly affects how large the increase is.\r\n\r\n#### Cross-origin URL Requests\r\n\r\nMy biggest blocker for performance was requests to CDNs and the size of the packages.\r\n\r\n[Stripe](https://stripe.com) is a common third-party resource and is an easy way to set up payment solutions for an app. It is recommended to load Stripe on all pages to help enhance fraud prevention.\r\n\r\nHere, I am loading Stripe globally in the Nuxt configuration using `preconnect` and `dns-prefetch`.\r\n\r\n`nuxt.config.js`\r\n\r\n```javascript\r\nexport default {\r\n  head: {\r\n    link: [\r\n      {\r\n        rel: 'preconnect',\r\n        href: 'https://m.stripe.com',\r\n        crossorigin: 'anonymous'\r\n      },\r\n      {\r\n        rel: 'dns-prefetch',\r\n        href: 'https://m.stripe.com'\r\n      }\r\n    ]\r\n  }\r\n}\r\n```\r\n\r\n`preconnect` and `dns-prefetch` are used in combination to both perform a DNS lookup and establish a connection to the server. These attributes allow the browser to do these tasks preemptively and in the background while the app is in use. Use these attributes where you can for resources that are not critical to the immediate page load.\r\n\r\nFor resources that are critical to the page load, you can use the `preload` attribute instead. This works in a similar fashion but tells the browser this resource is important and should be rendered as soon as possible without blocking rendering. This is useful to load some base page styles as to prevent Flash of Unstyled Text(FOUT) from occurring.\r\n\r\n### Remove Unused CSS\r\n\r\nI use Material Design Icons with Vuetify in my Nuxt projects. However, Vuetify makes a request to the CDN for the icon pack without preconnecting or prefetching.\r\n\r\n[Vuetify Docs](https://vuetifyjs.com/en/customization/icons/) recommend install the icon package locally and using custom imports in components for only the icons you use. This will prune any unused CSS for icons in production.\r\n\r\n`npm install --save @mdi/js`\r\n\r\nAfter that, in any `component.vue` file:\r\n\r\n```javascript\r\n<template>\r\n  <v-icon>{{ menuIcon }}</v-icon>\r\n</template>\r\n\r\n<script>\r\n  import { mdiMenu } from '@mdi/js'\r\n  export default {\r\n    data: () => ({\r\n      menuIcon: mdiMenu\r\n    }),\r\n  }\r\n</script>\r\n```\r\n\r\nWe also need to turn off the default icon loading from the Nuxt Vuetify module so that we aren't loading the resource twice.\r\n\r\n`nuxt.config.js`\r\n\r\n```javascript\r\nexport default {\r\n  vuetify: {\r\n    defaultAssets: {\r\n      icons: false\r\n    }\r\n  }\r\n}\r\n```\r\n\r\n### Nuxt Image Optimization\r\n\r\n[nuxt-optimized-images](https://github.com/aceforth/nuxt-optimized-images) allows you to use several image optimization packages with Nuxt acting as a plugin. You will need to include each [image optimization packages](https://github.com/aceforth/nuxt-optimized-images#optimization-packages) you want.\r\n\r\n### Unused CSS\r\n\r\n[nuxt-purgecss](https://github.com/Developmint/nuxt-purgecss) allows you to use [PurgeCSS](https://purgecss.com/) with Nuxt removing any unused CSS during the production build.\r\n\r\n## Conclusion\r\n\r\nUsing these methods and modules, my medium-sized, un-optimized app went from a 57 performance score to an 84. While there is still some work to be done to increase load times even more such as [serving images in next-gen formats](https://web.dev/uses-webp-images/?utm_source=lighthouse&utm_medium=devtools), I will leave that for another time.\r\n\r\n## Resources\r\n\r\n[Preconnect and Prefetch for Links](https://developer.mozilla.org/en-US/docs/Web/Performance/dns-prefetch) - https://developer.mozilla.org/en-US/docs/Web/Performance/dns-prefetch\r\n",
  "title": "Improve Google Page Speed Score In Nuxt Apps",
  "description": "Configuration for Scalable Nuxt Apps",
  "thumbnail": "/img/nuxt-tips.svg",
  "hero": "/img/nuxt-tips.svg"
}